---
layout: post
title:  "Xiongmai - An Investigative Journey 10 - Client Hijacking"
date:   2019-09-25 00:00:00 +0100
tags: xiongmai, hacking, ipc
permalink: /xiongmai/10
draft: true
---

In the original [VStarCam](/vstarcam/10) article, I hunted for a vulnerability that would allow me to take the original camera down during the client connection phase, potentially allowing me to slip into the place of the original. Now, I have a denial of service attack that can work against the camera without being logged in. VStarCam didn't even do some basic levels of checks like mac address, and instead opted to trust information you can get by talking to the camera in an unauthenticated state. Hopefully this one will prove to be a better challenge.

First, this is what the process needs to look like.

 1. Send DBP
 2. Get camera information from camera, DBP, DBR
    * GetSafetyAbility
    * OPMonitor
    * Login
 3. Repeatedly DoS camera
 4. Wait for DBP from client
 5. Send DBR to client
 6. Start Main Phase
   * Reply to GetSafetyAbility, OPMonitor
   * Stop when Login packet sent

